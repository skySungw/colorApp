(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sub/my/goods"],{"2e90":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(o("a34a")),s=o("c991");function a(t){return t&&t.__esModule?t:{default:t}}function c(t,e,o,n,s,a,c){try{var r=t[a](c),i=r.value}catch(u){return void o(u)}r.done?e(i):Promise.resolve(i).then(n,s)}function r(t){return function(){var e=this,o=arguments;return new Promise((function(n,s){var a=t.apply(e,o);function r(t){c(a,n,s,r,i,"next",t)}function i(t){c(a,n,s,r,i,"throw",t)}r(void 0)}))}}var i=function(){o.e("components/goods").then(function(){return resolve(o("04dd"))}.bind(null,o)).catch(o.oe)},u=function(){o.e("components/empty").then(function(){return resolve(o("c021"))}.bind(null,o)).catch(o.oe)},l={components:{Goods:i,Empty:u},data:function(){return{publishSource:1,allChecked:!1,showcaseId:null,goodsCode:null,source:0,customBar:this.CustomBar,params:{size:10,current:1,total:0,userId:"",goodsState:1},list:[],menu:[{id:1,label:"上架中",count:0},{id:0,label:"已下架",count:0},{id:2,label:"已售出",count:0}],curTab:0,scrollLeft:0,isBack:!0,noMoreFlag:!1}},onLoad:function(t){this.params.userId=t.id||"",this.isBack=1!=t.isBack,t.source&&(this.source=t.source,this.showcaseId=t.showcaseId,this.publishSource=4,t.goodsCode&&(this.goodsCode=t.goodsCode)),console.log("this.source",this.source),this.initParams()},methods:{onSelectGoodsTotal:function(){var t=this;return r(n.default.mark((function e(){var o;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.onSelectGoodsCountByMemberId)();case 3:o=e.sent,console.log("onSelectGoodsCountByMemberId res",o),200===o.code&&(t.menu[0]["count"]=o.data.upCount,t.menu[1]["count"]=o.data.downCount,t.menu[2]["count"]=o.data.soldCount),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},onPublish:function(){t.navigateTo({url:"/pages/sub/publish/publishGoods?source=".concat(this.source,"&showcaseId=").concat(this.showcaseId)})},onPublishToSite:function(){var e=this.getOperateNums(!0,!0),o=e.num,n=e.result;if(!o)return t.showToast({title:"请勾选商品",icon:"none"}),!1;this.addGoods(n)},addGoods:function(e){var o=this;return r(n.default.mark((function a(){var c;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,s.onAddGoodsToShowCase)({goodsIds:e,showcaseId:o.showcaseId});case 3:c=n.sent,200===c.code&&t.showToast({title:"添加成功",icon:"none",complete:function(){setTimeout((function(){t.navigateBack({delta:1})}),1500)}}),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](0),console.log("err",n.t0);case 10:case"end":return n.stop()}}),a,null,[[0,7]])})))()},getOperateNums:function(t,e){var o=0,n=[];return this.list.forEach((function(s,a){s.checked===t&&(o++,e&&n.push(s.goodsCode))})),e?{num:o,result:n}:o},onGoodsChecked:function(t){var e=t.currentTarget.dataset["index"],o=t.currentTarget.dataset["checked"];console.log("checked",!o,e),this.list[e].checked=!o,console.log("this.list",this.list),this.getOperateNums(!0)===this.list.length?this.allChecked=!0:this.allChecked=!1,this.$forceUpdate()},onCheckedAll:function(){var t=this;this.allChecked=!this.allChecked,this.list.forEach((function(e,o){t.list[o].checked=t.allChecked})),this.$forceUpdate()},hasNext:function(){return this.params.current<Math.ceil(this.params.total/this.params.size)},initParams:function(){this.onSelectGoodsTotal(),this.noMoreFlag=!1,this.params.current=1,this.params.total=0,this.list=[],this.getGoodsList()},getGoodsList:function(){var e=this;return r(n.default.mark((function o(){var a;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,(0,s.onFetchGoodsBySelf)(e.params);case 3:a=o.sent,200===a.code&&(e.params.total=a.data.total,e.list=e.list.concat(a.data.records),console.log("this.list",e.list),e.list.forEach((function(t,o){e.goodsCode==t.goodsCode?e.list[o].checked=!0:e.list[o].checked=!1})),e.goodsCode&&(e.goodsCode=null)),t.hideLoading(),o.next=12;break;case 8:o.prev=8,o.t0=o["catch"](0),t.hideLoading(),console.log("err",o.t0);case 12:case"end":return o.stop()}}),o,null,[[0,8]])})))()},tabSelect:function(t){this.curTab=t.currentTarget.dataset.index,this.params.goodsState=t.currentTarget.dataset.id,this.scrollLeft=60*(t.currentTarget.dataset.index-1),this.initParams()},onRefresh:function(){console.log("bottom"),this.hasNext()?(this.noMoreFlag=!1,this.params.current++,this.getGoodsList()):this.noMoreFlag=!0}}};e.default=l}).call(this,o("543d")["default"])},"4ea3":function(t,e,o){"use strict";var n;o.d(e,"b",(function(){return s})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}));var s=function(){var t=this,e=t.$createElement;t._self._c},a=[]},5540:function(t,e,o){"use strict";(function(t){o("cb01");n(o("66fd"));var e=n(o("def1"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=o,t(e.default)}).call(this,o("543d")["createPage"])},b3b4:function(t,e,o){"use strict";o.r(e);var n=o("2e90"),s=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=s.a},def1:function(t,e,o){"use strict";o.r(e);var n=o("4ea3"),s=o("b3b4");for(var a in s)"default"!==a&&function(t){o.d(e,t,(function(){return s[t]}))}(a);o("f385");var c,r=o("f0c5"),i=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],c);e["default"]=i.exports},f385:function(t,e,o){"use strict";var n=o("f4bd"),s=o.n(n);s.a},f4bd:function(t,e,o){}},[["5540","common/runtime","common/vendor"]]]);