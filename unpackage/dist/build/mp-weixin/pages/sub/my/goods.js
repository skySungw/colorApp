(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sub/my/goods"],{"1ec6":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(o("a34a")),n=o("651b");function a(t){return t&&t.__esModule?t:{default:t}}function c(t,e,o,s,n,a,c){try{var r=t[a](c),i=r.value}catch(u){return void o(u)}r.done?e(i):Promise.resolve(i).then(s,n)}function r(t){return function(){var e=this,o=arguments;return new Promise((function(s,n){var a=t.apply(e,o);function r(t){c(a,s,n,r,i,"next",t)}function i(t){c(a,s,n,r,i,"throw",t)}r(void 0)}))}}var i=function(){o.e("components/goods").then(function(){return resolve(o("ee12"))}.bind(null,o)).catch(o.oe)},u=function(){o.e("components/empty").then(function(){return resolve(o("e743"))}.bind(null,o)).catch(o.oe)},l={components:{Goods:i,Empty:u},data:function(){return{publishSource:1,allChecked:!1,showcaseId:null,goodsCode:null,source:0,customBar:this.CustomBar,params:{size:10,current:1,total:0,userId:"",goodsState:1},list:[],menu:[{id:1,label:"上架中"},{id:0,label:"已下架"},{id:2,label:"已售出"}],curTab:0,scrollLeft:0,isBack:!0,noMoreFlag:!1}},onLoad:function(t){this.params.userId=t.id||"",this.isBack=1!=t.isBack,t.source&&(this.source=t.source,this.showcaseId=t.showcaseId,this.publishSource=4,t.goodsCode&&(this.goodsCode=t.goodsCode)),console.log("this.source",this.source),this.initParams()},methods:{onPublish:function(){t.redirectTo({url:"/pages/sub/publish/publishGoods?source=".concat(this.source,"&showcaseId=").concat(this.showcaseId)})},onPublishToSite:function(){var e=this.getOperateNums(!0,!0),o=e.num,s=e.result;if(!o)return t.showToast({title:"请勾选商品",icon:"none"}),!1;this.addGoods(s)},addGoods:function(e){var o=this;return r(s.default.mark((function a(){var c;return s.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,n.onAddGoodsToShowCase)({goodsIds:e,showcaseId:o.showcaseId});case 3:c=s.sent,200===c.code&&t.showToast({title:"添加成功",icon:"none",complete:function(){setTimeout((function(){t.navigateBack({delta:1})}),1500)}}),s.next=10;break;case 7:s.prev=7,s.t0=s["catch"](0),console.log("err",s.t0);case 10:case"end":return s.stop()}}),a,null,[[0,7]])})))()},getOperateNums:function(t,e){var o=0,s=[];return this.list.forEach((function(n,a){n.checked===t&&(o++,e&&s.push(n.goodsCode))})),e?{num:o,result:s}:o},onGoodsChecked:function(t){var e=t.currentTarget.dataset["index"],o=t.currentTarget.dataset["checked"];console.log("checked",!o,e),this.list[e].checked=!o,console.log("this.list",this.list),this.getOperateNums(!0)===this.list.length?this.allChecked=!0:this.allChecked=!1,this.$forceUpdate()},onCheckedAll:function(){var t=this;this.allChecked=!this.allChecked,this.list.forEach((function(e,o){t.list[o].checked=t.allChecked})),this.$forceUpdate()},hasNext:function(){return this.params.current<Math.ceil(this.params.total/this.params.size)},initParams:function(){this.noMoreFlag=!1,this.params.current=1,this.params.total=0,this.list=[],this.getGoodsList()},getGoodsList:function(){var e=this;return r(s.default.mark((function o(){var a;return s.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,(0,n.onFetchGoodsBySelf)(e.params);case 3:a=o.sent,200===a.code&&(e.params.total=a.data.total,e.list=e.list.concat(a.data.records),console.log("this.list",e.list),e.list.forEach((function(t,o){e.goodsCode==t.goodsCode?e.list[o].checked=!0:e.list[o].checked=!1})),e.goodsCode&&(e.goodsCode=null)),t.hideLoading(),o.next=12;break;case 8:o.prev=8,o.t0=o["catch"](0),t.hideLoading(),console.log("err",o.t0);case 12:case"end":return o.stop()}}),o,null,[[0,8]])})))()},tabSelect:function(t){this.curTab=t.currentTarget.dataset.index,this.params.goodsState=t.currentTarget.dataset.id,this.scrollLeft=60*(t.currentTarget.dataset.index-1),this.initParams()},onRefresh:function(){console.log("bottom"),this.hasNext()?(this.noMoreFlag=!1,this.params.current++,this.getGoodsList()):this.noMoreFlag=!0}}};e.default=l}).call(this,o("543d")["default"])},"697e":function(t,e,o){"use strict";o.r(e);var s=o("1ec6"),n=o.n(s);for(var a in s)"default"!==a&&function(t){o.d(e,t,(function(){return s[t]}))}(a);e["default"]=n.a},a959:function(t,e,o){"use strict";(function(t){o("e8cf");s(o("66fd"));var e=s(o("bad9"));function s(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=o,t(e.default)}).call(this,o("543d")["createPage"])},ac32:function(t,e,o){"use strict";var s;o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return s}));var n=function(){var t=this,e=t.$createElement;t._self._c},a=[]},ad6f:function(t,e,o){},bad9:function(t,e,o){"use strict";o.r(e);var s=o("ac32"),n=o("697e");for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);o("d1c9");var c,r=o("f0c5"),i=Object(r["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],c);e["default"]=i.exports},d1c9:function(t,e,o){"use strict";var s=o("ad6f"),n=o.n(s);n.a}},[["a959","common/runtime","common/vendor"]]]);